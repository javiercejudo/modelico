!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Modelico=t()}(this,function(){"use strict";var e="12.6.0",t="Javier Cejudo <javier@javiercejudo.com> (http://www.javiercejudo.com)",n="MIT",r="https://github.com/javiercejudo/modelico#readme";const i=(e,t)=>t,u=(e,t)=>e.bind(void 0,t),o=(e,t,n,r)=>{if(""!==n)return r;const i=null===r?null:r.map(u(t.reviver,n));return new e(t,i)},c=(e,t,n,r)=>{return Object.freeze({type:e,reviver:o.bind(void 0,e,t)})},s=e=>()=>e,a=(e,t)=>void 0===t?e:t,f=e=>Object.keys(e).map((t=>[t,e[t]])),l=e=>e.reviver||i,h=(e,t)=>{if(!t.innerTypes)return e;const n=t.innerTypes(),r=Object.keys(n).reduce(((t,r)=>{if(t=h(e,n[r].type),t.hasOwnProperty(r)&&e[r].type.name!==n[r].type.name)throw new TypeError(`Duplicated typed key '${r}' with types ${e[r].type.name} and ${n[r].type.name}`);return t[r]=n[r],t}),{});return r},p=e=>{const t=h({},e);return(n,r)=>{if(""===n)return new e(r);const i=t[n];return i?l(i)("",r):r}};class d{constructor(e,t,n){n=a(this,n);n.type=s(e);n.fields=s(Object.freeze(t));Object.getOwnPropertyNames(t).forEach((e=>n[e]=s(t[e])));return n}set(e,t){const n=Object.assign({},this.fields(),{[e]:t});return new(this.type())(n)}setPath(e,t){if(e.length===0){return new(this.type())(t)}if(e.length===1){return this.set(e[0],t)}return this.set(e[0],this[e[0]]().setPath(e.slice(1),t))}equals(e){return JSON.stringify(this)===JSON.stringify(e)}toJSON(){return this.fields()}static factory(e,t,n){return new d(e,t,n)}static fromJSON(e,t){return JSON.parse(t,p(e))}static metadata(e){return Object.freeze({type:e,reviver:p(e)})}}var y=Object.freeze(d);class v extends y{constructor(e,t,n,r){super(e,{innerMap:r});this.innerTypes=s(Object.freeze({keyMetadata:t,valueMetadata:n}));this.innerMap=(()=>r===null?null:new Map(r));this[Symbol.iterator]=(()=>r[Symbol.iterator]());return this}setPath(e,t){if(e.length===0){const e=this.innerTypes();return new(this.type())(e.keyMetadata,e.keyMetadata,t)}const n=this.innerMap().get(e[0]);return this.set(e[0],n.setPath(e.slice(1),t))}static set(e,t,n){const r=this.innerTypes();const i=this.innerMap();i.set(t,n);return new e(r.keyMetadata,r.valueMetadata,i)}static metadata(e,t,n,r){return Object.freeze({type:e,reviver:t({keyMetadata:n,valueMetadata:r})})}}var m=Object.freeze(v),M=e=>Object.freeze({type:e,reviver:i}),b=Object.freeze({name:"Any"});const j=e=>({key:e[0],value:e[1]}),O=e=>t=>[l(e.keyMetadata)("",t.key),l(e.valueMetadata)("",t.value)],w=e=>(t,n)=>{if(""!==t)return n;const r=null===n?null:new Map(n.map(O(e)));return new S(e.keyMetadata,e.valueMetadata,r)};class S extends m{constructor(e,t,n){super(S,e,t,n);return Object.freeze(this)}set(e,t){return m.set.call(this,S,e,t)}toJSON(){const e=this.fields().innerMap;return e===null?null:Array.from(e).map(j)}static fromObject(e){return S.fromMap(new Map(f(e)))}static fromMap(e){return new S(M(String),M(b),e)}static metadata(e,t){return m.metadata(S,w,e,t)}}var z=Object.freeze(S);const g=(e,t)=>{return e[t[0].toJSON()]=t[1],e},T=(e,t)=>n=>[l(e.keyMetadata)("",n),l(e.valueMetadata)("",t[n])],k=e=>(t,n)=>{if(""!==t)return n;const r=null===n?null:new Map(Object.keys(n).map(T(e,n)));return new P(e.keyMetadata,e.valueMetadata,r)};class P extends m{constructor(e,t,n){super(P,e,t,n);return Object.freeze(this)}set(e,t){return m.set.call(this,P,e,t)}toJSON(){const e=this.fields().innerMap;return e===null?null:Array.from(e).reduce(g,{})}static metadata(e,t){return m.metadata(P,k,e,t)}}var A=Object.freeze(P);class C extends y{constructor(e){super(C,{date:e});this.date=(()=>e===null?null:new Date(e.getTime()));return Object.freeze(this)}set(e){return new C(e)}setPath(e,t){return this.set(t)}toJSON(){return this.date()===null?null:this.date().toISOString()}static reviver(e,t){const n=t===null?null:new Date(t);return new C(n)}static metadata(){return Object.freeze({type:C,reviver:C.reviver})}}var L=Object.freeze(C);class x extends y{constructor(e,t){super(x,{innerList:t});this.itemMetadata=s(e);this.innerList=(()=>t===null?null:t.slice());this[Symbol.iterator]=(()=>t[Symbol.iterator]());return Object.freeze(this)}set(e,t){const n=this.innerList();n[e]=t;return new x(this.itemMetadata(),n)}setPath(e,t){if(e.length===0){return new x(this.itemMetadata(),t)}const n=this.innerList()[e[0]];return this.set(e[0],n.setPath(e.slice(1),t))}toJSON(){return this.fields().innerList}static fromArray(e){return new x(M(b),e)}static metadata(e){return c(x,e)}}var N=Object.freeze(x);class U extends y{constructor(e,t){super(U,{innerSet:t});this.itemMetadata=s(e);this.innerSet=(()=>t===null?null:new Set(t));this[Symbol.iterator]=(()=>t[Symbol.iterator]());return Object.freeze(this)}set(e,t){const n=Array.from(this.innerSet());n[e]=t;return new U(this.itemMetadata(),n)}setPath(e,t){if(e.length===0){return new U(this.itemMetadata(),t)}const n=Array.from(this.innerSet())[e[0]];return this.set(e[0],n.setPath(e.slice(1),t))}toJSON(){const e=this.fields().innerSet;return e===null?null:Array.from(e)}static fromArray(e){return U.fromSet(new Set(e))}static fromSet(e){return new U(M(b),e)}static metadata(e){return c(U,e)}}var D=Object.freeze(U);const J=(e,t)=>(e[t]={code:t})&&e,E=(e,t,n)=>{return null===n?null:e[n]};class I extends y{constructor(e){const t=Array.isArray(e)?e.reduce(J,{}):e;super(I,t);Object.getOwnPropertyNames(t).forEach((e=>this[e]().toJSON=s(e)));this.metadata=s(Object.freeze({type:I,reviver:u(E,t)}));return Object.freeze(this)}}var Y=Object.freeze(I);let F;const H=(e,t,n,r,i)=>{return e.includes(i)?function(){const u=r[i].apply(r,arguments);return F(e,t,n,u)}:r[i]},W=(e,t,n,r,i,u,o)=>{return n.includes(o)?function(){const o=u.setPath([],t.apply(e,arguments));return F(n,r,i,o)}:r.includes(o)?function(){t.apply(e,arguments);const o=u.setPath([],e);return F(n,r,i,o)}:function(){return t.apply(e,arguments)}};F=((e,t,n,r)=>{const i=(r,i)=>{if(i in r)return H(e,t,n,r,i);const u=r[n](),o=u[i];return"function"==typeof o?W(u,o,e,t,n,r,i):o};return new Proxy(r,{get:i})});var q=F;const B=(e,t,n,r)=>e.bind(void 0,t,n,r),G=["set","setPath"],K=G,Q=["set","delete","clear"],R=G,V=["add","delete","clear"],X=G.concat(["concat","slice","filter"]),Z=["copyWithin","fill","pop","push","reverse","shift","sort","splice","unshift"],$=G,_=["setDate","setFullYear","setHours","setMinutes","setMilliseconds","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear"];var ee=Object.freeze({about:Object.freeze({version:e,author:t,homepage:r,license:n}),Any:b,AsIs:M,Date:L,Enum:Y,EnumMap:A,List:N,Map:z,Modelico:y,Set:D,proxyMap:B(q,K,Q,"innerMap"),proxyList:B(q,X,Z,"innerList"),proxySet:B(q,R,V,"innerSet"),proxyDate:B(q,$,_,"date")});return ee});
